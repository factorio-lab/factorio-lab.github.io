<ng-container *ngIf="vm$ | async as vm">
  <lab-header [sticky]="vm.scrollTop > 16"></lab-header>

  <ng-container *ngIf="vm.errorMsg == null; else errorDialog">
    <router-outlet></router-outlet>

    <div
      *ngIf="vm.routerLoading"
      class="position-absolute d-flex justify-content-center align-items-center vw-100 vh-100"
    >
      <p-progressSpinner></p-progressSpinner>
    </div>
  </ng-container>

  <ng-template #errorDialog>
    <p-dialog
      [visible]="true"
      [modal]="true"
      [draggable]="false"
      [resizable]="false"
      [closable]="false"
      [closeOnEscape]="false"
    >
      <ng-template pTemplate="header">
        <div class="p-dialog-title p-error">
          <i class="fa-solid fa-circle-exclamation me-2"></i>
          <span>{{ 'app.error' | translate }}</span>
        </div>
      </ng-template>
      <div class="p-error">
        <div>{{ 'app.errorDetail' | translate }}</div>
        <div class="mt-4">{{ vm.errorMsg }}</div>
        <div class="text-end mt-4">
          <button
            pButton
            pRipple
            [label]="'app.reset' | translate"
            [loading]="isResetting"
            (click)="reset(vm.game)"
          ></button>
        </div>
      </div>
    </p-dialog>
  </ng-template>
</ng-container>
